#!/bin/bash
#------------------------------------------------------------------------------------------
# Autor: Alberto Valero Mlynaricova
# Fecha: 16/12/2023
#
# DescripciÃ³n:  script que ejecuta un programa en python que crea recursos
#               USO: sudo   recurso       recurso1            alumnos
#                           programa    nombre recurso      nombre grupo del dominio
#------------------------------------------------------------------------------------------

if [ $# -ne 2 ]; then
    echo "Faltan argumentos... Uso: sudo recurso nombre_recurso grupo"
    exit 1
fi

apt -y update > /dev/null
apt -y install ssh sshpass curl gnupg apt-transport-https > /dev/null
yes | pip install --break-system-packages pywinrm > /dev/null

curl https://packages.microsoft.com/keys/microsoft.asc | sudo apt-key add -

codename=$(lsb_release -cs 2>/dev/null)
echo "deb [arch=amd64] https://packages.microsoft.com/repos/microsoft-debian-$codename-prod/ $codename main" | tee /etc/apt/sources.list.d/microsoft.list
apt -y update
apt -y install powershell

python3 nuevo_recurso.py $1 $2
